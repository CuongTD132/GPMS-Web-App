<div
    class="bg-card flex min-w-0 flex-auto flex-col dark:bg-transparent sm:absolute sm:inset-0 sm:overflow-hidden"
>
    <!-- Header -->
    <div
        class="relative flex flex-0 flex-col border-b px-6 py-8 sm:flex-row sm:items-center sm:justify-between md:px-8"
    >
        <!-- Title -->
        <div class="text-4xl font-extrabold tracking-tight">
            Production Results
        </div>
    </div>

    <!-- Production Plans list -->
    <div
        appHorizontalScroll
        class="flex flex-auto flex-col overflow-scroll sm:mb-18"
    >
        <div class="flex gap-2">
            <div
                class="text-secondary sticky top-0 z-10 grid w-full gap-4 bg-gray-50 px-6 py-4 text-md font-semibold shadow dark:bg-black dark:bg-opacity-5 md:px-8"
            >
                <ng-container
                    *ngIf="productionPlans$ | async as productionPlans"
                >
                    <mat-form-field class="w-full">
                        <mat-label>Select a working production plan:</mat-label>
                        <mat-select
                            (selectionChange)="getProReqs(selectedProPlan)"
                            [(value)]="selectedProPlan"
                        >
                            <ng-container
                                *ngFor="let productionPlan of productionPlans"
                            >
                                <mat-option value="{{ productionPlan.id }}"
                                    >{{ productionPlan.code }} -
                                    {{ productionPlan.name }}</mat-option
                                >
                            </ng-container>
                        </mat-select>
                    </mat-form-field>
                </ng-container>
                <ng-container
                    *ngIf="
                        productionPlan$ | async as productionPlan;
                        else loading
                    "
                >
                    <mat-form-field class="w-full">
                        <mat-label class="flex items-center gap-2"
                            >Select a production requirement:<span
                                *ngIf="selectedColor"
                                class="h-4 w-4 cursor-pointer rounded-full border border-gray-600"
                                [ngStyle]="{
                                    'background-color': selectedColor,
                                }"
                                matTooltip="{{ selectedColor }}"
                            ></span
                        ></mat-label>
                        <mat-select
                            (selectionChange)="findEstimations(selectedProReqs)"
                            [(value)]="selectedProReqs"
                        >
                            <ng-container
                                *ngFor="
                                    let productionRequirement of productionPlan.productionRequirements
                                "
                            >
                                <mat-option
                                    value="{{ productionRequirement.id }}"
                                >
                                    <div class="flex items-center gap-1">
                                        <p>
                                            {{
                                                productionRequirement
                                                    .productSpecification
                                                    .productCode
                                            }}
                                            -
                                            {{
                                                productionRequirement
                                                    .productSpecification
                                                    .productName
                                            }}
                                            - Size
                                            {{
                                                productionRequirement
                                                    .productSpecification.size
                                            }}
                                            - Required
                                            {{ productionRequirement.quantity }}
                                            pcs
                                        </p>
                                        <span
                                            class="h-4 w-4 cursor-pointer rounded-full border border-gray-600"
                                            [ngStyle]="{
                                                'background-color':
                                                    productionRequirement
                                                        .productSpecification
                                                        .colorCode,
                                            }"
                                            matTooltip="{{
                                                productionRequirement
                                                    .productSpecification
                                                    .colorCode
                                            }}"
                                        ></span></div
                                ></mat-option>
                            </ng-container>
                        </mat-select>
                    </mat-form-field>
                </ng-container>
                <ng-template #loading>
                    <mat-form-field>
                        <mat-label>Select a production requirement:</mat-label>
                        <mat-select> </mat-select>
                    </mat-form-field>
                </ng-template>
                <mat-form-field class="w-full">
                    <mat-label>Select an estimation:</mat-label>
                    <mat-select
                        (selectionChange)="findSeries(selectedEstimation)"
                        [(value)]="selectedEstimation"
                    >
                        <ng-container *ngFor="let item of estimationsList">
                            <mat-option value="{{ item.id }}">
                                <p>
                                    Day No: {{ item.dayNumber }} - Required
                                    {{ item.quantity }} pcs - Overtime Quantity:
                                    {{ item.overtimeQuantity }} pcs
                                </p></mat-option
                            >
                        </ng-container>
                    </mat-select>
                </mat-form-field>
            </div>
            <div
                class="text-secondary sticky top-0 z-10 grid w-full gap-4 bg-gray-50 px-6 py-4 text-md font-semibold shadow dark:bg-black dark:bg-opacity-5 md:px-8"
            >
                <mat-form-field class="w-full">
                    <mat-label>Select a series:</mat-label>
                    <mat-select
                        (selectionChange)="getProcessesList(selectedSeries)"
                        [(value)]="selectedSeries"
                    >
                        <ng-container *ngFor="let item of seriesList">
                            <mat-option value="{{ item.id }}">
                                <p>
                                    {{ item.code }} - Required
                                    {{ item.quantity }} pcs
                                    <ng-container *ngIf="item.currentProcess">
                                        - Current Process:
                                        {{ item.currentProcess }}
                                    </ng-container>

                                    - {{ item.status }}
                                </p></mat-option
                            >
                        </ng-container>
                    </mat-select>
                </mat-form-field>
                <mat-form-field class="w-full">
                    <mat-label>Select a process:</mat-label>
                    <mat-select
                        (selectionChange)="getStepsList(selectedProcess)"
                        [(value)]="selectedProcess"
                    >
                        <ng-container *ngFor="let item of processesList">
                            <mat-option value="{{ item.id }}">
                                <p>
                                    {{ item.orderNumber }}. {{ item.code }} -
                                    Quy trình
                                    {{ item.name }}
                                </p></mat-option
                            >
                        </ng-container>
                    </mat-select>
                </mat-form-field>
                <mat-form-field class="w-full">
                    <mat-label>Select a step:</mat-label>
                    <mat-select
                        (selectionChange)="getStepIOsList(selectedStep)"
                        [(value)]="selectedStep"
                    >
                        <ng-container *ngFor="let item of stepsList">
                            <mat-option value="{{ item.id }}">
                                <p>
                                    {{ item.orderNumber }}. {{ item.code }} -
                                    Bước
                                    {{ item.name }}
                                </p></mat-option
                            >
                        </ng-container>
                    </mat-select>
                </mat-form-field>
            </div>
        </div>
        <div *ngIf="stepIOsList">
            <mat-tab-group class="mt-4">
                <ng-container *ngIf="stepIOsList.inputs">
                    <mat-tab [label]="'Input List' | titlecase">
                        <mat-tab-group>
                            <ng-container
                                *ngIf="
                                    stepIOsList.inputs.materials &&
                                    stepIOsList.inputs.materials.length > 0
                                "
                            >
                                <mat-tab label="Materials"
                                    ><div class="flex flex-col gap-4">
                                        <div
                                            class="material-step-detail flex flex-col gap-2"
                                        >
                                            <div class="grid w-full">
                                                <div
                                                    class="material-step-detail-grid text-secondary grid gap-4 bg-gray-50 px-6 py-4 text-md font-semibold shadow dark:bg-black dark:bg-opacity-5 md:px-8"
                                                >
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Name
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Code
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Estimated consumption
                                                        for 1 pce
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Estimated consumption
                                                        for
                                                        {{
                                                            stepIOsList.seriesQuantity
                                                        }}
                                                        pcs
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Actual results
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Fill results
                                                    </div>
                                                </div>
                                                <div
                                                    class="max-h-80 overflow-y-scroll"
                                                >
                                                    <ng-container
                                                        *ngFor="
                                                            let item of stepIOsList
                                                                .inputs
                                                                .materials
                                                        "
                                                    >
                                                        <div
                                                            class="material-step-detail-grid grid items-center gap-4 border-b px-6 py-3 md:px-8"
                                                        >
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{ item.name }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{ item.code }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.consumption
                                                                }}
                                                                {{ item.unit }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.totalConsumption
                                                                }}
                                                                {{ item.unit }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.resultConsumption ||
                                                                        'Not yet available'
                                                                }}
                                                                <ng-container
                                                                    *ngIf="
                                                                        item.resultConsumption
                                                                    "
                                                                    >{{
                                                                        item.unit
                                                                    }}</ng-container
                                                                >
                                                            </div>
                                                            <mat-form-field
                                                                class="mt-4 h-fit w-full"
                                                                *ngIf="
                                                                    item.resultConsumption
                                                                "
                                                            >
                                                                <input
                                                                    disabled
                                                                    matInput
                                                                    placeholder="Result have been obtained!"
                                                                />
                                                            </mat-form-field>
                                                            <form
                                                                [formGroup]="
                                                                    consumptionForms[
                                                                        item.id
                                                                    ]
                                                                "
                                                            >
                                                                <div
                                                                    class="flex items-center gap-2"
                                                                    *ngIf="
                                                                        !item.resultConsumption
                                                                    "
                                                                >
                                                                    <mat-form-field
                                                                        class="mt-4 h-fit w-full"
                                                                    >
                                                                        <input
                                                                            type="number"
                                                                            matInput
                                                                            placeholder="Enter result here (Maximum is {{
                                                                                item.totalConsumption
                                                                            }})"
                                                                            min="0"
                                                                            max="{{
                                                                                item.totalConsumption
                                                                            }}"
                                                                            [formControlName]="
                                                                                'consumption'
                                                                            "
                                                                        />
                                                                    </mat-form-field>
                                                                    <button
                                                                        [disabled]="
                                                                            consumptionForms[
                                                                                item
                                                                                    .id
                                                                            ]
                                                                                .invalid
                                                                        "
                                                                        mat-button
                                                                        (click)="
                                                                            saveConsumptionForm(
                                                                                item.id
                                                                            )
                                                                        "
                                                                        class="hover:text-blue-500"
                                                                    >
                                                                        Save
                                                                    </button>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </ng-container>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </mat-tab>
                            </ng-container>
                            <ng-container
                                *ngIf="
                                    stepIOsList.inputs.semis &&
                                    stepIOsList.inputs.semis.length > 0
                                "
                            >
                                <mat-tab label="Semi Finished Products"
                                    ><div class="flex flex-col gap-4">
                                        <div
                                            class="material-step-detail flex flex-col gap-2"
                                        >
                                            <div class="grid w-full">
                                                <div
                                                    class="material-step-detail-grid text-secondary grid gap-4 bg-gray-50 px-6 py-4 text-md font-semibold shadow dark:bg-black dark:bg-opacity-5 md:px-8"
                                                >
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Name
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Code
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Estimated quantity for 1
                                                        pce
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Estimated quantity for
                                                        {{
                                                            stepIOsList.seriesQuantity
                                                        }}
                                                        pcs
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Actual results
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Fill results
                                                    </div>
                                                </div>
                                                <div
                                                    class="max-h-80 overflow-y-scroll"
                                                >
                                                    <ng-container
                                                        *ngFor="
                                                            let item of stepIOsList
                                                                .inputs.semis
                                                        "
                                                    >
                                                        <div
                                                            class="material-step-detail-grid grid items-center gap-4 border-b px-6 py-3 md:px-8"
                                                        >
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{ item.name }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{ item.code }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.quantity
                                                                }}
                                                                piece
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.totalQuantity
                                                                }}
                                                                {{ item.unit }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.resultQuantity ||
                                                                        'Not yet available'
                                                                }}
                                                                <ng-container
                                                                    *ngIf="
                                                                        item.resultQuantity
                                                                    "
                                                                    >{{
                                                                        item.unit
                                                                    }}</ng-container
                                                                >
                                                            </div>
                                                            <mat-form-field
                                                                class="mt-4 h-fit w-full"
                                                                *ngIf="
                                                                    item.resultQuantity
                                                                "
                                                            >
                                                                <input
                                                                    disabled
                                                                    matInput
                                                                    placeholder="Result have been obtained!"
                                                                />
                                                            </mat-form-field>
                                                            <form
                                                                [formGroup]="
                                                                    quantityForms[
                                                                        item.id
                                                                    ]
                                                                "
                                                            >
                                                                <div
                                                                    class="flex items-center gap-2"
                                                                    *ngIf="
                                                                        !item.resultQuantity
                                                                    "
                                                                >
                                                                    <mat-form-field
                                                                        class="mt-4 h-fit w-full"
                                                                    >
                                                                        <input
                                                                            type="number"
                                                                            matInput
                                                                            min="0"
                                                                            max="{{
                                                                                item.totalQuantity
                                                                            }}"
                                                                            placeholder="Enter result here (Maximum is {{
                                                                                item.totalQuantity
                                                                            }})"
                                                                            [formControlName]="
                                                                                'quantity'
                                                                            "
                                                                        />
                                                                    </mat-form-field>
                                                                    <button
                                                                        [disabled]="
                                                                            quantityForms[
                                                                                item
                                                                                    .id
                                                                            ]
                                                                                .invalid
                                                                        "
                                                                        mat-button
                                                                        (click)="
                                                                            saveQuantityForm(
                                                                                item.id
                                                                            )
                                                                        "
                                                                        class="hover:text-blue-500"
                                                                    >
                                                                        Save
                                                                    </button>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </ng-container>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </mat-tab>
                            </ng-container>
                            <ng-container
                                *ngIf="
                                    stepIOsList.inputs.products &&
                                    stepIOsList.inputs.products.length > 0
                                "
                            >
                                <mat-tab label="Products"
                                    ><div class="flex flex-col gap-4">
                                        <div
                                            class="material-step-detail flex flex-col gap-2"
                                        >
                                            <div class="grid w-full">
                                                <div
                                                    class="material-step-detail-grid text-secondary grid gap-4 bg-gray-50 px-6 py-4 text-md font-semibold shadow dark:bg-black dark:bg-opacity-5 md:px-8"
                                                >
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Name
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Code
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Estimated quantity for 1
                                                        pce
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Estimated quantity for
                                                        {{
                                                            stepIOsList.seriesQuantity
                                                        }}
                                                        pcs
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Actual results
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Fill results
                                                    </div>
                                                </div>
                                                <div
                                                    class="max-h-80 overflow-y-scroll"
                                                >
                                                    <ng-container
                                                        *ngFor="
                                                            let item of stepIOsList
                                                                .inputs.products
                                                        "
                                                    >
                                                        <div
                                                            class="material-step-detail-grid grid items-center gap-4 border-b px-6 py-3 md:px-8"
                                                        >
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{ item.name }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{ item.code }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.quantity
                                                                }}
                                                                piece
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.totalQuantity
                                                                }}
                                                                {{ item.unit }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.resultQuantity ||
                                                                        'Not yet available'
                                                                }}
                                                                <ng-container
                                                                    *ngIf="
                                                                        item.resultQuantity
                                                                    "
                                                                    >{{
                                                                        item.unit
                                                                    }}</ng-container
                                                                >
                                                            </div>
                                                            <mat-form-field
                                                                class="mt-4 h-fit w-full"
                                                                *ngIf="
                                                                    item.resultQuantity
                                                                "
                                                            >
                                                                <input
                                                                    matInput
                                                                    disabled
                                                                    placeholder="Result have been obtained!"
                                                                />
                                                            </mat-form-field>
                                                            <form
                                                                [formGroup]="
                                                                    quantityForms[
                                                                        item.id
                                                                    ]
                                                                "
                                                            >
                                                                <div
                                                                    class="flex items-center gap-2"
                                                                    *ngIf="
                                                                        !item.resultQuantity
                                                                    "
                                                                >
                                                                    <mat-form-field
                                                                        class="mt-4 h-fit w-full"
                                                                    >
                                                                        <input
                                                                            type="number"
                                                                            matInput
                                                                            min="0"
                                                                            max="{{
                                                                                item.totalQuantity
                                                                            }}"
                                                                            placeholder="Enter result here (Maximum is {{
                                                                                item.totalQuantity
                                                                            }})"
                                                                            [formControlName]="
                                                                                'quantity'
                                                                            "
                                                                        />
                                                                    </mat-form-field>
                                                                    <button
                                                                        [disabled]="
                                                                            quantityForms[
                                                                                item
                                                                                    .id
                                                                            ]
                                                                                .invalid
                                                                        "
                                                                        mat-button
                                                                        (click)="
                                                                            saveQuantityForm(
                                                                                item.id
                                                                            )
                                                                        "
                                                                        class="hover:text-blue-500"
                                                                    >
                                                                        Save
                                                                    </button>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </ng-container>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </mat-tab>
                            </ng-container>
                        </mat-tab-group></mat-tab
                    ></ng-container
                >
                <ng-container *ngIf="stepIOsList.outputs">
                    <mat-tab [label]="'Output List' | titlecase">
                        <mat-tab-group>
                            <ng-container
                                *ngIf="
                                    stepIOsList.outputs.materials &&
                                    stepIOsList.outputs.materials.length > 0
                                "
                            >
                                <mat-tab label="Materials"
                                    ><div class="flex flex-col gap-4">
                                        <div
                                            class="material-step-detail flex flex-col gap-2"
                                        >
                                            <div class="grid w-full">
                                                <div
                                                    class="material-step-detail-grid text-secondary grid gap-4 bg-gray-50 px-6 py-4 text-md font-semibold shadow dark:bg-black dark:bg-opacity-5 md:px-8"
                                                >
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Name
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Code
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Estimated consumption
                                                        for 1 pce
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Estimated consumption
                                                        for
                                                        {{
                                                            stepIOsList.seriesQuantity
                                                        }}
                                                        pcs
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Actual results
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Fill results
                                                    </div>
                                                </div>
                                                <div
                                                    class="max-h-80 overflow-y-scroll"
                                                >
                                                    <ng-container
                                                        *ngFor="
                                                            let item of stepIOsList
                                                                .outputs
                                                                .materials
                                                        "
                                                    >
                                                        <div
                                                            class="material-step-detail-grid grid items-center gap-4 border-b px-6 py-3 md:px-8"
                                                        >
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{ item.name }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{ item.code }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.consumption
                                                                }}
                                                                {{ item.unit }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.totalConsumption
                                                                }}
                                                                {{ item.unit }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.resultConsumption ||
                                                                        'Not yet available'
                                                                }}
                                                                <ng-container
                                                                    *ngIf="
                                                                        item.resultConsumption
                                                                    "
                                                                    >{{
                                                                        item.unit
                                                                    }}</ng-container
                                                                >
                                                            </div>
                                                            <mat-form-field
                                                                class="mt-4 h-fit w-full"
                                                                *ngIf="
                                                                    item.resultConsumption
                                                                "
                                                            >
                                                                <input
                                                                    disabled
                                                                    matInput
                                                                    placeholder="Result have been obtained!"
                                                                />
                                                            </mat-form-field>
                                                            <form
                                                                [formGroup]="
                                                                    consumptionForms[
                                                                        item.id
                                                                    ]
                                                                "
                                                            >
                                                                <div
                                                                    class="flex items-center gap-2"
                                                                    *ngIf="
                                                                        !item.resultConsumption
                                                                    "
                                                                >
                                                                    <mat-form-field
                                                                        class="mt-4 h-fit w-full"
                                                                    >
                                                                        <input
                                                                            type="number"
                                                                            matInput
                                                                            placeholder="Enter result here (Maximum is {{
                                                                                item.totalConsumption
                                                                            }})"
                                                                            min="0"
                                                                            max="{{
                                                                                item.totalConsumption
                                                                            }}"
                                                                            [formControlName]="
                                                                                'consumption'
                                                                            "
                                                                        />
                                                                    </mat-form-field>
                                                                    <button
                                                                        [disabled]="
                                                                            consumptionForms[
                                                                                item
                                                                                    .id
                                                                            ]
                                                                                .invalid
                                                                        "
                                                                        mat-button
                                                                        (click)="
                                                                            saveConsumptionForm(
                                                                                item.id
                                                                            )
                                                                        "
                                                                        class="hover:text-blue-500"
                                                                    >
                                                                        Save
                                                                    </button>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </ng-container>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </mat-tab>
                            </ng-container>
                            <ng-container
                                *ngIf="
                                    stepIOsList.outputs.semis &&
                                    stepIOsList.outputs.semis.length > 0
                                "
                            >
                                <mat-tab label="Semi Finished Products"
                                    ><div class="flex flex-col gap-4">
                                        <div
                                            class="material-step-detail flex flex-col gap-2"
                                        >
                                            <div class="grid w-full">
                                                <div
                                                    class="material-step-detail-grid text-secondary grid gap-4 bg-gray-50 px-6 py-4 text-md font-semibold shadow dark:bg-black dark:bg-opacity-5 md:px-8"
                                                >
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Name
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Code
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Estimated quantity for 1
                                                        pce
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Estimated quantity for
                                                        {{
                                                            stepIOsList.seriesQuantity
                                                        }}
                                                        pcs
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Actual results
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Fill results
                                                    </div>
                                                </div>
                                                <div
                                                    class="max-h-80 overflow-y-scroll"
                                                >
                                                    <ng-container
                                                        *ngFor="
                                                            let item of stepIOsList
                                                                .outputs.semis
                                                        "
                                                    >
                                                        <div
                                                            class="material-step-detail-grid grid items-center gap-4 border-b px-6 py-3 md:px-8"
                                                        >
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{ item.name }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{ item.code }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.quantity
                                                                }}
                                                                piece
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.totalQuantity
                                                                }}
                                                                {{ item.unit }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.resultQuantity ||
                                                                        'Not yet available'
                                                                }}
                                                                <ng-container
                                                                    *ngIf="
                                                                        item.resultQuantity
                                                                    "
                                                                    >{{
                                                                        item.unit
                                                                    }}</ng-container
                                                                >
                                                            </div>
                                                            <mat-form-field
                                                                class="mt-4 h-fit w-full"
                                                                *ngIf="
                                                                    item.resultQuantity
                                                                "
                                                            >
                                                                <input
                                                                    disabled
                                                                    matInput
                                                                    placeholder="Result have been obtained!"
                                                                />
                                                            </mat-form-field>
                                                            <form
                                                                [formGroup]="
                                                                    quantityForms[
                                                                        item.id
                                                                    ]
                                                                "
                                                            >
                                                                <div
                                                                    class="flex items-center gap-2"
                                                                    *ngIf="
                                                                        !item.resultQuantity
                                                                    "
                                                                >
                                                                    <mat-form-field
                                                                        class="mt-4 h-fit w-full"
                                                                    >
                                                                        <input
                                                                            type="number"
                                                                            matInput
                                                                            min="0"
                                                                            max="{{
                                                                                item.totalQuantity
                                                                            }}"
                                                                            placeholder="Enter result here (Maximum is {{
                                                                                item.totalQuantity
                                                                            }})"
                                                                            [formControlName]="
                                                                                'quantity'
                                                                            "
                                                                        />
                                                                    </mat-form-field>
                                                                    <button
                                                                        [disabled]="
                                                                            quantityForms[
                                                                                item
                                                                                    .id
                                                                            ]
                                                                                .invalid
                                                                        "
                                                                        mat-button
                                                                        (click)="
                                                                            saveQuantityForm(
                                                                                item.id
                                                                            )
                                                                        "
                                                                        class="hover:text-blue-500"
                                                                    >
                                                                        Save
                                                                    </button>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </ng-container>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </mat-tab>
                            </ng-container>
                            <ng-container
                                *ngIf="
                                    stepIOsList.outputs.products &&
                                    stepIOsList.outputs.products.length > 0
                                "
                            >
                                <mat-tab label="Products"
                                    ><div class="flex flex-col gap-4">
                                        <div
                                            class="material-step-detail flex flex-col gap-2"
                                        >
                                            <div class="grid w-full">
                                                <div
                                                    class="material-step-detail-grid text-secondary grid gap-4 bg-gray-50 px-6 py-4 text-md font-semibold shadow dark:bg-black dark:bg-opacity-5 md:px-8"
                                                >
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Name
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Code
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Estimated quantity for 1
                                                        pce
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Estimated quantity for
                                                        {{
                                                            stepIOsList.seriesQuantity
                                                        }}
                                                        pcs
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Actual results
                                                    </div>
                                                    <div
                                                        class="hidden sm:block"
                                                    >
                                                        Fill results
                                                    </div>
                                                </div>
                                                <div
                                                    class="max-h-80 overflow-y-scroll"
                                                >
                                                    <ng-container
                                                        *ngFor="
                                                            let item of stepIOsList
                                                                .outputs
                                                                .products
                                                        "
                                                    >
                                                        <div
                                                            class="material-step-detail-grid grid items-center gap-4 border-b px-6 py-3 md:px-8"
                                                        >
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{ item.name }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{ item.code }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.quantity
                                                                }}
                                                                piece
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.totalQuantity
                                                                }}
                                                                {{ item.unit }}
                                                            </div>
                                                            <div
                                                                class="hidden sm:block"
                                                            >
                                                                {{
                                                                    item.resultQuantity ||
                                                                        'Not yet available'
                                                                }}
                                                                <ng-container
                                                                    *ngIf="
                                                                        item.resultQuantity
                                                                    "
                                                                    >{{
                                                                        item.unit
                                                                    }}</ng-container
                                                                >
                                                            </div>
                                                            <mat-form-field
                                                                class="mt-4 h-fit w-full"
                                                                *ngIf="
                                                                    item.resultQuantity
                                                                "
                                                            >
                                                                <input
                                                                    matInput
                                                                    disabled
                                                                    placeholder="Result have been obtained!"
                                                                />
                                                            </mat-form-field>
                                                            <form
                                                                [formGroup]="
                                                                    quantityForms[
                                                                        item.id
                                                                    ]
                                                                "
                                                            >
                                                                <div
                                                                    class="flex items-center gap-2"
                                                                    *ngIf="
                                                                        !item.resultQuantity
                                                                    "
                                                                >
                                                                    <mat-form-field
                                                                        class="mt-4 h-fit w-full"
                                                                    >
                                                                        <input
                                                                            type="number"
                                                                            matInput
                                                                            min="0"
                                                                            max="{{
                                                                                item.totalQuantity
                                                                            }}"
                                                                            placeholder="Enter result here (Maximum is {{
                                                                                item.totalQuantity
                                                                            }})"
                                                                            [formControlName]="
                                                                                'quantity'
                                                                            "
                                                                        />
                                                                    </mat-form-field>
                                                                    <button
                                                                        [disabled]="
                                                                            quantityForms[
                                                                                item
                                                                                    .id
                                                                            ]
                                                                                .invalid
                                                                        "
                                                                        mat-button
                                                                        (click)="
                                                                            saveQuantityForm(
                                                                                item.id
                                                                            )
                                                                        "
                                                                        class="hover:text-blue-500"
                                                                    >
                                                                        Save
                                                                    </button>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </ng-container>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </mat-tab>
                            </ng-container>
                        </mat-tab-group></mat-tab
                    ></ng-container
                >
            </mat-tab-group>
            <div
                *ngIf="inputOutputResults && inputOutputResults.length > 0"
                class="mt-4 flex justify-end pr-8"
            >
                <button
                    [disabled]="totalIO !== inputOutputResults.length"
                    (click)="submit()"
                    mat-raised-button
                    color="primary"
                    class="flex min-w-fit gap-2"
                >
                    <span> Submit Step Result </span>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Notification -->
<a class="cursor-pointer" *ngIf="flashMessage">
    <fuse-alert
        class="absolute bottom-0 right-0 z-999"
        [type]="'success'"
        [appearance]="'border'"
        *ngIf="flashMessage === 'success'"
    >
        <span fuseAlertTitle>Success</span>
        {{ message }}
    </fuse-alert>
    <fuse-alert
        class="absolute bottom-0 right-0 z-999"
        [type]="'error'"
        [appearance]="'border'"
        *ngIf="flashMessage === 'error'"
    >
        <span fuseAlertTitle>Error</span>
        {{ message }}
    </fuse-alert>
</a>
